(function(e){function t(e,t,s){var o=80;n(e,o,t);var u=r(e,o,t,s);e.css(u);i(e,s)}function n(e,t,n){e.css({display:"inline",fontSize:t,letterSpacing:"0px",textAlign:n.textAlign,whiteSpace:"nowrap",paddingRight:"0px",paddingLeft:"0px",marginRight:"0px",marginLeft:"0px"})}function r(e,t,n,r){var i=e.parent(),s=c(e,i,r),h=e.width(),p=h/s,d=1,v=.1,m=1e3,g,y,b,w;var E=n.width.toString(),S=parseInt(n.width),x=E.indexOf("px")>0?"pixel":"percent",T=x==="pixel"?S/s:S/100,N=s*T;var C=o(t,p,T);e.css("font-size",C);g=n.relativeSpacing?f(r.letterSpacing,s,m):r.letterSpacing;e.css("letter-spacing",g);if(e.width()<=N){var k=u(e,N,"font-size",C,d);w=k-d}else{w=a(e,N,C,d)}if(n.minFontSize&&w<n.minFontSize){w=n.minFontSize}else if(n.maxFontSize&&w>n.maxFontSize){w=n.maxFontSize}e.css("font-size",w);if(n.preciseMode&&w!=n.minFontSize&&w!=n.maxFontSize){var L=u(e,N,"letter-spacing",g,v);y=L-v}else{y=g}if(y<0){final_text_indent=Math.round((r.textIndent+y)*.5)}else{final_text_indent=r.textIndent}return{fontSize:w,letterSpacing:l(y,1)+"px",textIndent:final_text_indent+"px"}}function i(e,t){e.css({display:"",whiteSpace:"",visibility:"",paddingRight:t.paddingRight,paddingLeft:t.paddingLeft,marginRight:t.marginRight,marginLeft:t.marginLeft})}function s(e,t,n){if(typeof n.letterSpacing=="object"){t.letterSpacing=parseFloat(e.css("letter-spacing"))}else{t.letterSpacing=parseFloat(n.letterSpacing)}return t}function o(e,t,n){return Math.floor(e*n/t)}function u(e,t,n,r,i){var s=0;while(e.width()<t){r+=i;e.css(n,r);s++}return r}function a(e,t,n,r){while(e.width()>t){n-=r;e.css("font-size",n)}return n}function f(e,t,n){return e/n*t}function l(e,t){var n=e>=0?1:-1;return(Math.round(e*Math.pow(10,t)+n*.001)/Math.pow(10,t)).toFixed(t)}function c(e,t,n){return t.width()-n.paddingLeft-n.paddingRight-n.marginLeft-n.marginRight}e.fn.percentext=function(n){var r=e.extend({},e.fn.percentext.defaults,n);return this.each(function(){var n=e(this),i={};i=s(n,i,r);i.textIndent=parseInt(n.css("text-indent"));i.paddingLeft=parseInt(n.css("padding-left"));i.paddingRight=parseInt(n.css("padding-right"));i.marginLeft=parseInt(n.css("margin-left"));i.marginRight=parseInt(n.css("margin-right"));n.css("visibility","hidden");var o;e(window).bind("resize",function(){clearTimeout(o);o=setTimeout(t(n,r,i),400)});e(window).bind("load",function(){t(n,r,i)})})};e.fn.percentext.defaults={width:100,textAlign:null,preciseMode:true,letterSpacing:null,relativeSpacing:true,minFontSize:null,maxFontSize:null}})(jQuery)
